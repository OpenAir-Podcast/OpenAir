name: Flutter CI # Renamed the workflow to reflect use of Flutter

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  # Adding workflow_dispatch allows manual triggering of the workflow
  workflow_dispatch:

jobs:
  ci:
    name: Continuous Integration Checks
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup Flutter SDK # Use Flutter setup instead of Dart setup
        # This action installs the Flutter SDK, which includes the Dart SDK.
        uses: subosito/flutter-action@v2
        with:
          channel: 'stable'

      - name: Install Dependencies
        run: flutter pub get # FIX: Use 'flutter pub get' for Flutter projects

      - name: Verify Formatting
        # Ensures all code adheres to Dart formatting standards
        run: flutter format --output=none --set-exit-if-changed . # FIX: Use 'flutter format'

      - name: Analyze Project Source (Strict)
        # Passes '--fatal-infos' to enforce stricter code analysis
        run: flutter analyze --fatal-infos # FIX: Use 'flutter analyze'

      - name: Run Tests
        # Runs all tests in the 'test/' directory
        run: flutter test # FIX: Use 'flutter test' for Flutter projects
